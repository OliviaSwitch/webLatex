\chapter{多元函数微分学}

\section{可微性}

\subsection{偏导数}

\begin{definition}
    设函数$z=f(x,y)$在点$(x_0,y_0)$的某邻域内有定义，当$x$在$x_0$处有增量$\Delta x$，$y$在$y_0$处有增量\\$\Delta y$时，相应的函数有增量$\Delta z=f(x_0+\Delta x,y_0+\Delta y)-f(x_0,y_0)$，如果极限
        \[
            \lim_{\Delta x\to 0}\frac{\Delta z}{\Delta x}=\lim_{\Delta x\to 0}\frac{f(x_0+\Delta x,y_0+\Delta y)-f(x_0,y_0)}{\Delta x}
        \]
        存在，则称此极限为函数$z=f(x,y)$在点$(x_0,y_0)$处对$x$的偏导数，记作
        \[
            \left.\frac{\partial z}{\partial x}\right|_{(x_0,y_0)}\quad\text{或}\quad f'_x(x_0,y_0)\quad\text{或}\quad z'_x
        \]
        同理可得函数$z=f(x,y)$在点$(x_0,y_0)$处对$y$的偏导数。
\end{definition}

怎么求：
\begin{itemize}
    \item 对$x$的偏导数：将$y$看作常数，对$x$求导；
    \item 对$y$的偏导数：将$x$看作常数，对$y$求导。
\end{itemize}

\subsubsection{关于连续性}

\begin{enumerate}
    \item 对于一元函数，可导必定连续
    \item 对于多元函数，偏导数存在不一定连续
\end{enumerate}

\subsection{全微分}

\begin{definition}
    设函数$z=f(x,y)$在点$(x_0,y_0)$的某邻域内有定义，且在该点有偏导数，则称函数\\$z=f(x,y)$在点$(x_0,y_0)$处可微分，如果存在常数$A$和$B$，使得全增量
        \[
            \Delta z=A\Delta x+B\Delta y+o(\rho)
        \]
        其中$\rho=\sqrt{(\Delta x)^2+(\Delta y)^2}$，则称$A\Delta x+B\Delta y$为函数$z=f(x,y)$在点$P_0=(x_0,y_0)$处的全微分，记作
        \[
            \left.\mathrm{d}z\right|_{P_0}=df(x_0,y_0)=A\Delta x+B\Delta y
        \]
        当$\Delta x$和$\Delta y$趋于零时，全微分$\mathrm{d}z$可作为全增量$\Delta z$的近似值，于是有近似公式
    \[
        f(x,y)\approx f(x_0,y_0)+A(x-x_0)+B(y-y_0)
    \]
\end{definition}

\subsubsection{可微性条件}

% \begin{theorem}
%     函数$z=f(x,y)$在点$(x_0,y_0)$处可微分的充分必要条件是：函数$z=f(x,y)$在点$(x_0,y_0)$处的偏导数存在且连续。
% \end{theorem}

\begin{theorem}
    若二元函数 $f$ 在其定义域内一点 $(x_0,y_0)$ 处可微，则 $f$ 在该点关于每个自变量的偏导数都存在。
    此时，全微分可写成
    \[
        \mathrm{d}f(x,y)=f_x(x,y)\mathrm{d}x+f_y(x,y)\mathrm{d}y
    \]
\end{theorem}

\begin{theorem}[可微的充分条件]
    若函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处的偏导数 $f_x(x_0,y_0)$ 和 $f_y(x_0,y_0)$ 存在且连续，则 $f$ 在该点可微。
\end{theorem}

另外，连续是可微的一个必要条件。

\subsection{曲面的切平面与法线}

\begin{definition}
    设曲面 $z=f(x,y)$ 在点 $(x_0,y_0,z_0)$ 处可微，且 $f_x(x_0,y_0)\neq 0$，则曲面在该点的切平面方程为
    \[
        z-z_0=f_x(x_0,y_0)(x-x_0)+f_y(x_0,y_0)(y-y_0)
    \]
\end{definition}

同理，有曲面 $F(x,y,z)=0$ 在点 $(x_0,y_0,z_0)$ 处可微，则曲面在该店的切平面方程为
\[
    F_x(x_0,y_0,z_0)(x-x_0)+F_y(x_0,y_0,z_0)(y-y_0)+F_z(x_0,y_0,z_0)(z-z_0)=0
\]

\begin{definition}
    设曲面 $z=f(x,y)$ 在点 $(x_0,y_0,z_0)$ 处可微，且 $f_x(x_0,y_0)\neq 0$，则曲面在该点的法线方程为
    \[
        \frac{x-x_0}{f_x(x_0,y_0)}=\frac{y-y_0}{f_y(x_0,y_0)}=\frac{z-z_0}{-1}
    \]
\end{definition}

同理，有曲面 $F(x,y,z)=0$ 在点 $(x_0,y_0,z_0)$ 处可微，则曲面在该店的法线方程为
\[
    \frac{x-x_0}{F_x(x_0,y_0,z_0)}=\frac{y-y_0}{F_y(x_0,y_0,z_0)}=\frac{z-z_0}{F_z(x_0,y_0,z_0)}
\]


\section{复合函数微分法}

\subsection{复合函数的偏导数}

\begin{theorem}
    设函数 $z=f(u,v)$ 在点 $(u,v)$ 处可微，函数 $u=u(x,y)$ 和 $v=v(x,y)$ 分别在点 $(x,y)$ 处可微，则复合函数 $z=f(u(x,y),v(x,y))$ 在点 $(x,y)$ 处可微，且有
    \[
        \begin{aligned}
            \frac{\partial z}{\partial x} & =\frac{\partial z}{\partial u}\frac{\partial u}{\partial x}+\frac{\partial z}{\partial v}\frac{\partial v}{\partial x} \\
            \frac{\partial z}{\partial y} & =\frac{\partial z}{\partial u}\frac{\partial u}{\partial y}+\frac{\partial z}{\partial v}\frac{\partial v}{\partial y}
        \end{aligned}
    \]
\end{theorem}

特殊情况：有函数 $z=f(u,x,y), u=u(x,y)$，则
\[
    \begin{aligned}
        \frac{\partial z}{\partial x}=\frac{\partial f}{\partial u}\frac{\partial u}{\partial x}+\frac{\partial f}{\partial x} \\
        \frac{\partial z}{\partial y}=\frac{\partial f}{\partial u}\frac{\partial u}{\partial y}+\frac{\partial f}{\partial y}
    \end{aligned}
\]
这里，把 $f$ 看作 $u,x,y$ 三个变量的函数，$z$ 看作 $x,y$ 两个变量的函数。

\subsection{复合函数的全微分}

\begin{theorem}
    设函数 $z=f(u,v)$ 在点 $(u,v)$ 处可微，函数 $u=u(x,y)$ 和 $v=v(x,y)$ 分别在点 $(x,y)$ 处可微，则复合函数 $z=f(u(x,y),v(x,y))$ 在点 $(x,y)$ 处可微，且有
    \[
        \mathrm{d}z=\frac{\partial z}{\partial u}\mathrm{d}u+\frac{\partial z}{\partial v}\mathrm{d}v
    \]
\end{theorem}

\section{方向导数与梯度}

\subsection{方向导数}

\begin{definition}
    设函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 的某邻域内有定义，点 $P_0(x_0,y_0)$ 处沿方向 $\bm{l}=(\cos\alpha,\cos\beta)$ 的方向导数为
    \[
        \frac{\partial z}{\partial l}=\lim_{\rho\to 0}\frac{f(x_0+\rho\cos\alpha,y_0+\rho\cos\beta)-f(x_0,y_0)}{\rho}
    \]
    其中 $\rho=\sqrt{(\cos\alpha)^2+(\cos\beta)^2}$。
\end{definition}

\begin{theorem}
    函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处可微，则函数在该点沿任一方向 $\bm{l}=(\cos\alpha,\cos\beta)$ 的方向导数存在，且有
    \[
        \frac{\partial z}{\partial l}=f_x(x_0,y_0)\cos\alpha+f_y(x_0,y_0)\cos\beta
    \]
\end{theorem}

\subsection{梯度}

\begin{definition}
    设函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处可微，定义函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处的梯度为
    \[
        \nabla f(x_0,y_0)=\left(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y}\right)
    \]
\end{definition}

\begin{theorem}
    函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处可微，则函数在该点的梯度 $\nabla f(x_0,y_0)$ 就是函数在该点沿各个方向的方向导数的最大值，且有
    \[
        \frac{\partial z}{\partial l}=\nabla f(x_0,y_0)\cdot\bm{l}
    \]
\end{theorem}

\section{泰勒公式与极值}

\subsection{高阶偏导数}

二元函数的二阶偏导数有如下四种形式:
\[
    \begin{aligned}
        f_{xx} & =\frac{\partial^2 f}{\partial x^2}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial x}\right)         \\
        f_{yy} & =\frac{\partial^2 f}{\partial y^2}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial y}\right)         \\
        f_{xy} & =\frac{\partial^2 f}{\partial x\partial y}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial x}\right) \\
        f_{yx} & =\frac{\partial^2 f}{\partial y\partial x}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial y}\right)
    \end{aligned}
\]

另外，称 $\frac{\partial^2 f}{\partial x\partial y}$ 和 $\frac{\partial^2 f}{\partial y\partial x}$ 这种既有关于 $x$, 又有关于 $y$ 的高阶偏导数为混合偏导数。
\begin{theorem}
    若函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处的二阶偏导数 $f_{xx},f_{yy},f_{xy},f_{yx}$ 都存在且连续，则
    \[
        f_{xy}(x_0,y_0)=f_{yx}(x_0,y_0)
    \]
\end{theorem}

\subsubsection{复合函数的高阶偏导数}

设
\[
    z=f(x,y), x=\varphi(s,t), y=\phi(s,t)
\]
若函数 $f,\varphi,\phi$ 都具有连续的二阶偏导数，则复合函数 $z=f(\varphi(s,t),\phi(s,t))$ 对 $s,t$ 同样存在二阶连续偏导数。
\[
    \begin{aligned}
        \frac{\partial z}{\partial s}=\frac{\partial z}{\partial x}\frac{\partial x}{\partial s}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial s} \\
        \frac{\partial z}{\partial t}= \frac{\partial z}{\partial x}\frac{\partial x}{\partial t}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial t}
    \end{aligned}
\]
显然 $\frac{\partial z}{\partial s},\frac{\partial z}{\partial t}$ 仍然是 $s,t$ 的复合函数，其中 $\frac{\partial z}{\partial x},\frac{\partial z}{\partial y}$ 是 $x,y$ 的函数，$\frac{\partial x}{\partial s},\frac{\partial x}{\partial t}, \frac{\partial y}{\partial s}, \frac{\partial y}{\partial t}$ 是 $s,t$ 的函数。
继续求... （求不出来了）

\subsection{中值定理和泰勒公式}

\begin{theorem}[拉格朗日中值定理]
    设函数 $z=f(x,y)$ 在凸开域 $D\in R^2$ 连续，在 $D$ 的所有内点都可微，则对于 $D$ 内任意两点 $P(a,b),Q(a+h,b+k)\in D, \forall\theta(0<\theta<1)$，使得
    \[
        f(a+h,b+k)-f(a,b)=f_x(a+\theta h,b+\theta k)h+f_y(a+\theta h,b+\theta k)k
    \]
\end{theorem}

\begin{theorem}[泰勒公式]
    设函数 $z=f(x,y)$ 在点 $P_0(x_0,y_0)$ 的某邻域内具有 $n+1$ 阶连续偏导数，则对于任意一点 $(x_0+h,y_0+k),\forall \theta \in (0,1)$，使得
    \[
        \begin{aligned}
            f(x_0+h,y_0+k) & =f(x_0,y_0)+(h\frac{\partial}{\partial x}+k\frac{\partial}{\partial y})f(x_0,y_0)+\frac{1}{2!}(h\frac{\partial}{\partial x}+k\frac{\partial}{\partial y})^2f(x_0,y_0)+\cdots \\
                           & +\frac{1}{n!}(h\frac{\partial}{\partial x}+k\frac{\partial}{\partial y})^nf(x_0,y_0)+R_n
        \end{aligned}
    \]
    其中 $R_n$ 为拉格朗日余项，即
    \[
        R_n=\frac{1}{(n+1)!}(h\frac{\partial}{\partial x}+k\frac{\partial}{\partial y})^{n+1}f(x_0+\theta h,y_0+\theta k)
    \]
\end{theorem}

前面的中值定理是泰勒公式的特殊情况，即 $n=0$。

若只要求 $R_n=o(\rho^n)$，此时 $n$ 阶泰勒公式为
\[
    f(x_0+h,y_0+k)=\sum_{p=1}^n\frac{1}{p!}(h\frac{\partial}{\partial x}+k\frac{\partial}{\partial y})^pf(x_0,y_0)+o(\rho^n)
\]

实际优化问题的目标函数往往比较复杂。为了使问题简化，通常将目标函数在某点附近展开为泰勒(Taylor)多项式来逼近原函数。

一元函数在点 $x_k$ 处的泰勒展开式为：
\[
    f(x)=f(x_k)+f'(x_k)(x-x_k)+\frac{1}{2}f''(x_k)(x-x_k)^2+o^n)
\]

二元函数在点$(x_k,x_y)$处的泰勒展开式为：
\[
    \begin{aligned}
        f(x,y) & =f(x_k,y_k)+(x-x_k)f_x(x_k,y_k)+(y-y_k)f_y(x_k,y_k)                                                 \\
               & +\frac{1}{2!}[(x-x_k)^2f_{xx}(x_k,y_k)+2(x-x_k)(y-y_k)f_{xy}(x_k,y_k)+(y-y_k)^2f_{yy}(x_k,y_k)]+o^n
    \end{aligned}
\]

\subsection{极值}

\begin{definition}
    设函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 的某邻域内有定义，如果存在这个邻域内的任意一点 $(x,y)$，使得 $f(x,y)\leq f(x_0,y_0)$，则称 $f(x_0,y_0)$ 是函数 $z=f(x,y)$ 的一个极大值点；如果存在这个邻域内的任意一点 $(x,y)$，使得 $f(x,y)\geq f(x_0,y_0)$，则称 $f(x_0,y_0)$ 是函数 $z=f(x,y)$ 的一个极小值点。
\end{definition}

\begin{theorem}[极值的必要条件]
    设函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处有极值，且在该点处有偏导数，则有
    \[
        f_x(x_0,y_0)=0,f_y(x_0,y_0)=0
    \]
\end{theorem}

\begin{definition}[稳定点]，即驻点
    若函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处有偏导数，且在该点处有偏导数 $f_x(x_0,y_0)=0,f_y(x_0,y_0)=0$，则称点 $(x_0,y_0)$ 为函数 $z=f(x,y)$ 的一个稳定点。
\end{definition}

\begin{itemize}
    \item 稳定点不一定是极值点；
    \item 极值点一定是稳定点。
\end{itemize}

\begin{theorem}[极值的充分条件]判断驻点是否等于极值点\\
    设函数 $z=f(x,y)$ 在点 $P_0(x_0,y_0)$ 处有连续偏导数，且在该点处有偏导数 $f_x(x_0,y_0)=0,f_y(x_0,y_0)=0$，则有
    \begin{itemize}
        \item 若 $f_{xx}(P_0)f_{yy}(P_0)-f_{xy}^2(P_0)>0$，则 $P_0$ 是函数 $z=f(x,y)$ 的一个极值点：
              \begin{itemize}
                  \item 若 $f_{xx}(P_0)>0$，则 $P_0$ 是函数 $z=f(x,y)$ 的一个极小值点；
                  \item 若 $f_{xx}(P_0)<0$，则 $P_0$ 是函数 $z=f(x,y)$ 的一个极大值点。
              \end{itemize}
        \item 若 $f_{xx}(P_0)f_{yy}(P_0)-f_{xy}^2(P_0)<0$，则 $P_0$ 不是函数 $z=f(x,y)$ 的一个极值点；
        \item 若 $f_{xx}(P_0)f_{yy}(P_0)-f_{xy}^2(P_0)=0$，则无法判断$P_0$ 是否为函数 $z=f(x,y)$ 的一个极值点。
    \end{itemize}
\end{theorem}